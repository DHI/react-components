import { hexColorToArray, latLngToUtm, utmToLatLng } from "./helpers";
import { VesselViewDefinition } from "./types";

export const vesselsToGeoJson3D = (shipData: any) => {
  if (shipData.length == 0) {
    return [];
  }

  return shipData.features
    .map((vesselFeature: any) => {
      const {
        ShipType,
        Heading,
        Width,
        Length,
        ToBow,
        ToStern,
        ToPort,
        ToStarboard,
      } = vesselFeature.properties;

      const lastCoordinate = vesselFeature.geometry.coordinates[0];
      const secondLastCoordinate = vesselFeature.geometry.coordinates[1];

      const colorLight = "#42a5f5";
      const colorMiddle = "#1976D2";
      const colorDark = "#0D47A1";

      const vesselViewDefinition = getVesselViewDefinition(ShipType, colorLight, colorMiddle, colorDark);

      // const test = getVesselPolygons(null, ShipType, );

      const geoJsonFeatures = getVesselPolygons(
        vesselViewDefinition,
        secondLastCoordinate,
        lastCoordinate,
        Heading,
        Width,
        Length,
        ToBow,
        ToStern,
        ToPort,
        ToStarboard,
        ShipType
      );

      // Add in original properties for tooltips.
      const updatedFeature = geoJsonFeatures.map((feature) => ({
        ...feature,
        properties: {
          ...feature.properties,
          ...vesselFeature.properties,
        },
      }));

      return updatedFeature;
    })
    .flat();
};

const getVesselViewDefinition = (
  shipType: number,
  colorLight: string,
  colorMiddle: string,
  colorDark: string
) : VesselViewDefinition => {
  const vessels: VesselViewDefinition[] = [
    {
      // Passenger
      pick: false,
      from: 60,
      to: 69,
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.988, 0.182],
            [0.954, 0.344],
            [0.92, 0.498],
            [0.886, 0.606],
            [0.842, 0.734],
            [0.79, 0.848],
            [0.738, 0.936],
            [0.686, 1.0],
            [0.624, 1.0],
            [-0.73, 1.0],
            [-0.806, 0.97],
            [-0.858, 0.936],
            [-0.902, 0.868],
            [-0.93, 0.782],
            [-0.962, 0.646],
            [-0.978, 0.498],
            [-0.99, 0.37],
            [-0.998, 0.25],
            [-1.0, 0.122],
            [-1.0, -0.122],
            [-0.998, -0.25],
            [-0.99, -0.37],
            [-0.978, -0.498],
            [-0.962, -0.646],
            [-0.93, -0.782],
            [-0.902, -0.868],
            [-0.858, -0.936],
            [-0.806, -0.97],
            [-0.73, -1.0],
            [0.624, -1.0],
            [0.686, -1.0],
            [0.738, -0.936],
            [0.79, -0.848],
            [0.842, -0.734],
            [0.886, -0.606],
            [0.92, -0.498],
            [0.954, -0.344],
            [0.988, -0.182],
            [1.0, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [0.658, 0.0],
            [0.658, 0.182],
            [0.656, 0.39],
            [0.648, 0.518],
            [0.638, 0.646],
            [0.62, 0.788],
            [0.608, 0.888],
            [0.62, 0.956],
            [0.662, 0.97],
            [0.694, 0.922],
            [0.718, 0.842],
            [0.728, 0.76],
            [0.738, 0.66],
            [0.748, 0.546],
            [0.758, 0.424],
            [0.758, 0.304],
            [0.758, 0.188],
            [0.768, 0.088],
            [0.768, -0.088],
            [0.758, -0.188],
            [0.758, -0.304],
            [0.758, -0.424],
            [0.748, -0.546],
            [0.738, -0.66],
            [0.728, -0.76],
            [0.718, -0.842],
            [0.694, -0.922],
            [0.662, -0.97],
            [0.62, -0.956],
            [0.608, -0.888],
            [0.62, -0.788],
            [0.638, -0.646],
            [0.648, -0.518],
            [0.656, -0.39],
            [0.658, -0.182],
            [0.658, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [0.586, 0.0],
            [0.586, 0.128],
            [0.576, 0.216],
            [0.57, 0.324],
            [0.562, 0.424],
            [0.552, 0.518],
            [0.542, 0.62],
            [0.504, 0.654],
            [0.476, 0.654],
            [0.432, 0.654],
            [0.318, 0.654],
            [0.284, 0.754],
            [0.252, 0.782],
            [0.212, 0.794],
            [0.164, 0.754],
            [0.146, 0.686],
            [0.128, 0.612],
            [0.094, 0.612],
            [0.068, 0.708],
            [0.042, 0.68],
            [0.032, 0.586],
            [0.016, 0.506],
            [0.03, 0.35],
            [0.016, 0.188],
            [0.016, -0.188],
            [0.03, -0.35],
            [0.016, -0.506],
            [0.032, -0.586],
            [0.042, -0.68],
            [0.068, -0.708],
            [0.094, -0.612],
            [0.128, -0.612],
            [0.146, -0.686],
            [0.164, -0.754],
            [0.212, -0.794],
            [0.252, -0.782],
            [0.284, -0.754],
            [0.318, -0.654],
            [0.432, -0.654],
            [0.476, -0.654],
            [0.504, -0.654],
            [0.542, -0.62],
            [0.552, -0.518],
            [0.562, -0.424],
            [0.57, -0.324],
            [0.576, -0.216],
            [0.586, -0.128],
            [0.586, 0.0],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.462, 0.0],
            [-0.46, 0.128],
            [-0.448, 0.336],
            [-0.438, 0.506],
            [-0.432, 0.64],
            [-0.414, 0.72],
            [-0.046, 0.72],
            [-0.046, 0.626],
            [-0.042, 0.506],
            [-0.03, 0.404],
            [-0.018, 0.304],
            [-0.016, 0.182],
            [-0.016, -0.182],
            [-0.018, -0.304],
            [-0.03, -0.404],
            [-0.042, -0.506],
            [-0.046, -0.626],
            [-0.046, -0.72],
            [-0.414, -0.72],
            [-0.432, -0.64],
            [-0.438, -0.506],
            [-0.448, -0.336],
            [-0.46, -0.128],
            [-0.462, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.472, 0.0],
            [-0.476, 0.202],
            [-0.486, 0.398],
            [-0.5, 0.566],
            [-0.518, 0.72],
            [-0.548, 0.848],
            [-0.586, 0.91],
            [-0.658, 0.848],
            [-0.686, 0.74],
            [-0.706, 0.566],
            [-0.718, 0.398],
            [-0.728, 0.208],
            [-0.73, 0.08],
            [-0.73, -0.08],
            [-0.728, -0.208],
            [-0.718, -0.398],
            [-0.706, -0.566],
            [-0.686, -0.74],
            [-0.658, -0.848],
            [-0.586, -0.91],
            [-0.548, -0.848],
            [-0.518, -0.72],
            [-0.5, -0.566],
            [-0.486, -0.398],
            [-0.476, -0.202],
            [-0.472, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.792, 0.0],
            [-0.792, 0.108],
            [-0.792, 0.29],
            [-0.776, 0.424],
            [-0.766, 0.552],
            [-0.744, 0.64],
            [-0.72, 0.68],
            [-0.718, 0.802],
            [-0.776, 0.808],
            [-0.844, 0.788],
            [-0.872, 0.674],
            [-0.89, 0.552],
            [-0.91, 0.43],
            [-0.92, 0.296],
            [-0.92, 0.188],
            [-0.92, 0.08],
            [-0.92, -0.08],
            [-0.92, -0.188],
            [-0.92, -0.296],
            [-0.91, -0.43],
            [-0.89, -0.552],
            [-0.872, -0.674],
            [-0.844, -0.788],
            [-0.776, -0.808],
            [-0.718, -0.802],
            [-0.72, -0.68],
            [-0.744, -0.64],
            [-0.766, -0.552],
            [-0.776, -0.424],
            [-0.792, -0.29],
            [-0.792, -0.108],
            [-0.792, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.074, 0.0],
            [-0.084, 0.128],
            [-0.108, 0.216],
            [-0.15, 0.236],
            [-0.188, 0.236],
            [-0.366, 0.236],
            [-0.394, 0.208],
            [-0.408, 0.162],
            [-0.418, 0.094],
            [-0.418, -0.094],
            [-0.408, -0.162],
            [-0.394, -0.208],
            [-0.366, -0.236],
            [-0.188, -0.236],
            [-0.15, -0.236],
            [-0.108, -0.216],
            [-0.084, -0.128],
            [-0.074, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [0.436, 0.0],
            [0.424, 0.134],
            [0.412, 0.208],
            [0.386, 0.154],
            [0.36, 0.182],
            [0.326, 0.228],
            [0.314, 0.324],
            [0.29, 0.384],
            [0.264, 0.472],
            [0.228, 0.478],
            [0.184, 0.478],
            [0.166, 0.41],
            [0.154, 0.33],
            [0.15, 0.25],
            [0.142, 0.154],
            [0.142, 0.08],
            [0.142, -0.08],
            [0.142, -0.154],
            [0.15, -0.25],
            [0.154, -0.33],
            [0.166, -0.41],
            [0.184, -0.478],
            [0.228, -0.478],
            [0.264, -0.472],
            [0.29, -0.384],
            [0.314, -0.324],
            [0.326, -0.228],
            [0.36, -0.182],
            [0.386, -0.154],
            [0.412, -0.208],
            [0.424, -0.134],
            [0.436, 0.0],
          ],
        },
      ],
    },
    {
      // Cargo
      pick: false,
      from: 70,
      to: 79,
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.99, 0.15],
            [0.97, 0.31],
            [0.94, 0.42],
            [0.91, 0.51],
            [0.88, 0.6],
            [0.84, 0.69],
            [0.79, 0.78],
            [0.74, 0.85],
            [0.69, 0.9],
            [0.64, 0.96],
            [0.6, 1.0],
            [-0.61, 1.0],
            [-0.67, 0.97],
            [-0.73, 0.92],
            [-0.78, 0.86],
            [-0.84, 0.79],
            [-0.88, 0.73],
            [-0.93, 0.65],
            [-0.96, 0.6],
            [-0.99, 0.53],
            [-0.99, -0.53],
            [-0.96, -0.6],
            [-0.93, -0.65],
            [-0.88, -0.73],
            [-0.84, -0.79],
            [-0.78, -0.86],
            [-0.73, -0.92],
            [-0.67, -0.97],
            [-0.61, -1.0],
            [0.6, -1.0],
            [0.64, -0.96],
            [0.69, -0.9],
            [0.74, -0.85],
            [0.79, -0.78],
            [0.84, -0.69],
            [0.88, -0.6],
            [0.91, -0.51],
            [0.94, -0.42],
            [0.97, -0.31],
            [0.99, -0.15],
            [1.0, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.63, 0.8],
            [-0.78, 0.8],
            [-0.78, -0.8],
            [-0.63, -0.8],
            [-0.63, 0.8],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.16, 0.67],
            [-0.16, -0.67],
            [-0.46, -0.67],
            [-0.46, 0.67],
            [-0.16, 0.67],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [0.29, 0.67],
            [0.29, -0.67],
            [-0.01, -0.67],
            [-0.01, 0.67],
            [0.29, 0.67],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [0.74, 0.67],
            [0.74, -0.67],
            [0.44, -0.67],
            [0.44, 0.67],
            [0.74, 0.67],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorDark,
          coordinates: [
            [-0.61, 0.5],
            [-0.68, 0.5],
            [-0.68, -0.5],
            [-0.61, -0.5],
            [-0.61, 0.5],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.78, 0.6],
            [-0.85, 0.6],
            [-0.85, -0.6],
            [-0.78, -0.6],
            [-0.78, 0.6],
          ],
        },
      ],
    },
    {
      // Tanker
      pick: false,
      from: 80,
      to: 89,
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.98, 0.3],
            [0.95, 0.58],
            [0.9, 0.74],
            [0.84, 0.88],
            [0.784, 0.96],
            [0.7, 1.0],
            [-0.78, 1.0],
            [-0.87, 0.91],
            [-0.95, 0.78],
            [-0.986, 0.64],
            [-1.0, 0.48],
            [-1.0, -0.48],
            [-0.986, -0.64],
            [-0.95, -0.78],
            [-0.87, -0.91],
            [-0.78, -1.0],
            [0.7, -1.0],
            [0.784, -0.96],
            [0.84, -0.88],
            [0.9, -0.74],
            [0.95, -0.58],
            [0.98, -0.3],
            [1.0, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.48, -0.12],
            [-0.44, -0.1],
            [0.9, -0.1],
            [0.9, -0.14],
            [0.98, -0.14],
            [0.98, 0.14],
            [0.9, 0.14],
            [0.9, 0.1],
            [-0.44, 0.1],
            [-0.48, 0.12],
            [-0.48, 0.72],
            [-0.44, 0.72],
            [-0.44, 0.98],
            [-0.56, 0.98],
            [-0.56, 0.72],
            [-0.52, 0.72],
            [-0.52, -0.72],
            [-0.56, -0.72],
            [-0.56, -0.98],
            [-0.44, -0.98],
            [-0.44, -0.72],
            [-0.48, -0.72],
            [-0.48, -0.12],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorDark,
          coordinates: [
            [-0.68, 0.4],
            [-0.68, 0.8],
            [-0.82, 0.8],
            [-0.82, -0.8],
            [-0.68, -0.8],
            [-0.68, -0.4],
            [-0.64, -0.26],
            [-0.64, 0.26],
            [-0.68, 0.4],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.92, 0.64],
            [-0.92, -0.64],
            [-0.84, -0.64],
            [-0.84, 0.64],
            [-0.92, 0.64],
          ],
        },
      ],
      points: {
        fairleadCoefficients: [
          [-1.0, 0.0],
          [-0.95, 0.8],
          [-0.6, 1.0],
          [0.6, 1.0],
          [0.85, 0.65],
          [1.0, 0.0],
        ],
        winchCoefficients: [
          [-0.91, 0.0],
          [-0.95, 0.18],
          [-0.6, 0.38],
          [0.6, 0.38],
          [0.85, 0.03],
          [0.91, 0.0],
        ],
      },
    },
    {
      // Yacht
      pick: true,
      from: 36,
      to: 36,
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.958, 0.078],
            [0.886, 0.17],
            [0.806, 0.248],
            [0.71, 0.344],
            [0.6, 0.458],
            [0.46, 0.594],
            [0.346, 0.684],
            [0.236, 0.768],
            [0.142, 0.838],
            [0.06, 0.884],
            [-0.018, 0.92],
            [-0.112, 0.954],
            [-0.198, 0.974],
            [-0.24, 0.988],
            [-0.298, 1.0],
            [-0.39, 0.984],
            [-0.46, 0.97],
            [-0.542, 0.952],
            [-0.62, 0.932],
            [-0.696, 0.904],
            [-0.78, 0.878],
            [-0.852, 0.844],
            [-0.92, 0.802],
            [-0.952, 0.694],
            [-0.968, 0.53],
            [-0.99, 0.406],
            [-1.0, 0.146],
            [-1.0, -0.146],
            [-0.99, -0.406],
            [-0.968, -0.53],
            [-0.952, -0.694],
            [-0.92, -0.802],
            [-0.852, -0.844],
            [-0.78, -0.878],
            [-0.696, -0.904],
            [-0.62, -0.932],
            [-0.542, -0.952],
            [-0.46, -0.97],
            [-0.39, -0.984],
            [-0.298, -1.0],
            [-0.24, -0.988],
            [-0.198, -0.974],
            [-0.112, -0.954],
            [-0.018, -0.92],
            [0.06, -0.884],
            [0.142, -0.838],
            [0.236, -0.768],
            [0.346, -0.684],
            [0.46, -0.594],
            [0.6, -0.458],
            [0.71, -0.344],
            [0.806, -0.248],
            [0.886, -0.17],
            [0.958, -0.078],
            [1.0, 0.0],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [-0.03, 0.832],
            [-1.0, 0.0],
            [0.26, -0.024],
            [1.0, 0.0],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorDark,
          coordinates: [
            [0.558, 0.0],
            [0.558, 0.084],
            [0.558, 0.194],
            [0.538, 0.272],
            [0.508, 0.314],
            [0.452, 0.364],
            [0.398, 0.416],
            [0.314, 0.468],
            [0.242, 0.516],
            [0.18, 0.554],
            [0.098, 0.594],
            [0.0, 0.636],
            [-0.102, 0.678],
            [-0.19, 0.704],
            [-0.27, 0.722],
            [-0.37, 0.734],
            [-0.456, 0.734],
            [-0.596, 0.736],
            [-0.696, 0.732],
            [-0.79, 0.732],
            [-0.844, 0.732],
            [-0.914, 0.718],
            [-0.934, 0.58],
            [-0.948, 0.308],
            [-0.954, 0.092],
            [-0.954, -0.092],
            [-0.948, -0.308],
            [-0.934, -0.58],
            [-0.914, -0.718],
            [-0.844, -0.732],
            [-0.79, -0.732],
            [-0.696, -0.732],
            [-0.596, -0.736],
            [-0.456, -0.734],
            [-0.37, -0.734],
            [-0.27, -0.722],
            [-0.19, -0.704],
            [-0.102, -0.678],
            [0.0, -0.636],
            [0.098, -0.594],
            [0.18, -0.554],
            [0.242, -0.516],
            [0.314, -0.468],
            [0.398, -0.416],
            [0.452, -0.364],
            [0.508, -0.314],
            [0.538, -0.272],
            [0.558, -0.194],
            [0.558, -0.084],
            [0.558, 0.0],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorDark,
          coordinates: [
            [0.508, 0.182],
            [0.414, 0.198],
            [0.414, -0.198],
            [0.508, -0.182],
            [0.508, 0.182],
          ],
        },
      ],
    },
    {
      // Container
      pick: false,
      from: -1,
      to: -1,
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.99, 0.15],
            [0.97, 0.31],
            [0.94, 0.42],
            [0.91, 0.51],
            [0.88, 0.6],
            [0.84, 0.69],
            [0.79, 0.78],
            [0.74, 0.85],
            [0.69, 0.9],
            [0.64, 0.96],
            [0.6, 1.0],
            [-0.61, 1.0],
            [-0.67, 0.97],
            [-0.73, 0.92],
            [-0.78, 0.86],
            [-0.84, 0.79],
            [-0.88, 0.73],
            [-0.93, 0.65],
            [-0.96, 0.6],
            [-0.99, 0.53],
            [-0.99, -0.53],
            [-0.96, -0.6],
            [-0.93, -0.65],
            [-0.88, -0.73],
            [-0.84, -0.79],
            [-0.78, -0.86],
            [-0.73, -0.92],
            [-0.67, -0.97],
            [-0.61, -1.0],
            [0.6, -1.0],
            [0.64, -0.96],
            [0.69, -0.9],
            [0.74, -0.85],
            [0.79, -0.78],
            [0.84, -0.69],
            [0.88, -0.6],
            [0.91, -0.51],
            [0.94, -0.42],
            [0.97, -0.31],
            [0.99, -0.15],
            [1.0, 0.0],
          ],
        },
        {
          color: colorLight,
          outlineColor: colorDark,
          coordinates: [
            [0.89, 0.2],
            [0.89, -0.2],
            [0.8, -0.2],
            [0.8, 0.2],
            [0.89, 0.2],
          ],
        },
        {
          color: colorLight,
          outlineColor: colorDark,
          coordinates: [
            [0.74, 0.67],
            [-0.61, 0.67],
            [-0.61, -0.67],
            [0.74, -0.67],
            [0.74, 0.67],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.59, -0.22],
            [0.44, -0.22],
            [0.44, 0.22],
            [0.59, 0.22],
            [0.59, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.29, -0.22],
            [0.14, -0.22],
            [0.14, 0.22],
            [0.29, 0.22],
            [0.29, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.01, -0.22],
            [-0.16, -0.22],
            [-0.16, 0.22],
            [-0.01, 0.22],
            [-0.01, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.31, -0.22],
            [-0.46, -0.22],
            [-0.46, 0.22],
            [-0.31, 0.22],
            [-0.31, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.59, 0.22],
            [0.74, 0.22],
            [0.74, 0.67],
            [0.59, 0.67],
            [0.59, 0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.59, -0.22],
            [0.74, -0.22],
            [0.74, -0.67],
            [0.59, -0.67],
            [0.59, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.44, 0.22],
            [0.44, 0.67],
            [0.29, 0.67],
            [0.29, 0.22],
            [0.44, 0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [0.44, -0.22],
            [0.29, -0.22],
            [0.29, -0.67],
            [0.44, -0.67],
            [0.44, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.01, 0.22],
            [0.14, 0.22],
            [0.14, 0.67],
            [-0.01, 0.67],
            [-0.01, 0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.01, -0.22],
            [0.14, -0.22],
            [0.14, -0.67],
            [-0.01, -0.67],
            [-0.01, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.16, 0.22],
            [-0.31, 0.22],
            [-0.31, 0.67],
            [-0.16, 0.67],
            [-0.16, 0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.16, -0.22],
            [-0.16, -0.67],
            [-0.31, -0.67],
            [-0.31, -0.22],
            [-0.16, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.46, 0.22],
            [-0.61, 0.22],
            [-0.61, 0.67],
            [-0.46, 0.67],
            [-0.46, 0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorDark,
          coordinates: [
            [-0.46, -0.22],
            [-0.61, -0.22],
            [-0.61, -0.67],
            [-0.46, -0.67],
            [-0.46, -0.22],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.63, 0.8],
            [-0.78, 0.8],
            [-0.78, -0.8],
            [-0.63, -0.8],
            [-0.63, 0.8],
          ],
        },
        {
          isAccomodation: true,
          color: colorDark,
          outlineColor: colorDark,
          coordinates: [
            [-0.61, 0.5],
            [-0.68, 0.5],
            [-0.68, -0.5],
            [-0.61, -0.5],
            [-0.61, 0.5],
          ],
        },
        {
          color: colorMiddle,
          outlineColor: colorMiddle,
          coordinates: [
            [-0.78, 0.6],
            [-0.85, 0.6],
            [-0.85, -0.6],
            [-0.78, -0.6],
            [-0.78, 0.6],
          ],
        },
      ],
      points: {
        fairleadCoefficients: [
          [-1.0, 0.0],
          [-0.95, 0.8],
          [-0.6, 1.0],
          [0.6, 1.0],
          [0.85, 0.65],
          [1.0, 0.0],
        ],
        winchCoefficients: [
          [-0.91, 0.0],
          [-0.95, 0.18],
          [-0.6, 0.38],
          [0.6, 0.38],
          [0.85, 0.03],
          [0.91, 0.0],
        ],
      },
    },
  ];

  let vessel = vessels.find((vessel: VesselViewDefinition) => {
    return shipType >= vessel.from && shipType <= vessel.to;
  });
  
  if (!vessel) {
    vessel = {
      polygons: [
        {
          isHull: true,
          color: colorLight,
          outlineColor: colorMiddle,
          coordinates: [
            [1.0, 0.0],
            [0.99, 0.15],
            [0.97, 0.31],
            [0.94, 0.42],
            [0.91, 0.51],
            [0.88, 0.6],
            [0.84, 0.69],
            [0.79, 0.78],
            [0.74, 0.85],
            [0.69, 0.9],
            [0.64, 0.96],
            [0.6, 1.0],
            [-0.61, 1.0],
            [-0.67, 0.97],
            [-0.73, 0.92],
            [-0.78, 0.86],
            [-0.84, 0.79],
            [-0.88, 0.73],
            [-0.93, 0.65],
            [-0.96, 0.6],
            [-0.99, 0.53],
            [-0.99, -0.53],
            [-0.96, -0.6],
            [-0.93, -0.65],
            [-0.88, -0.73],
            [-0.84, -0.79],
            [-0.78, -0.86],
            [-0.73, -0.92],
            [-0.67, -0.97],
            [-0.61, -1.0],
            [0.6, -1.0],
            [0.64, -0.96],
            [0.69, -0.9],
            [0.74, -0.85],
            [0.79, -0.78],
            [0.84, -0.69],
            [0.88, -0.6],
            [0.91, -0.51],
            [0.94, -0.42],
            [0.97, -0.31],
            [0.99, -0.15],
            [1.0, 0.0],
          ],
        },
      ],
    }
  }

  return vessel;
};

const getVesselPolygons = (
  vessel: any,
  latitude: number,
  longitude: number,
  heading: number,
  width: number,
  length: number,
  toBow: number,
  toStern: number,
  toPort: number,
  toStar: number,
  shipType: any
) => {
  // Port + start = width
  let vesselFeatures: any[] = [];

  if (width != -1 && length != -1) {
    if (toStern == -1 || toStern == null) {
      toStern = length / 2;
    }

    if (toPort == -1 || toPort == null) {
      toPort = width / 2;
    }
  }

  var utm = latLngToUtm(latitude, longitude);

  var radians = (Math.PI / 180) * (-heading + 90);
  var cos = Math.cos(radians);
  var sin = Math.sin(radians);

  vessel.polygons.forEach((polygon: any) => {
    polygon.coordinates.forEach((coordinate: any) => {
      var x = (length * coordinate[0]) / 2 + (length / 2 - toStern);
      var y = (width * coordinate[1]) / 2 - (width / 2 - toPort);

      var newX = cos * x - sin * y + utm.easting;
      var newY = cos * y + sin * x + utm.northing;

      var geo = utmToLatLng(utm.zone, newX, newY, utm.northernHemisphere);

      coordinate[0] = geo.longitude;
      coordinate[1] = geo.latitude;
    });

    const colorArray = hexColorToArray(polygon.color, 1);
    let elevation;
    if (polygon.isHull) {
      elevation = 15;
    } else if (polygon.isAccomodation) {
      elevation = 25;
    } else {
      elevation = 22;
    }

    vesselFeatures.push({
      type: "Feature",
      geometry: {
        type: "MultiPolygon",
        coordinates: [[polygon.coordinates]],
      },
      properties: {
        style: {
          fillColor: colorArray,
          fillOpacity: 1,
          color: polygon.outlineColor,
          opacity: 1,
          weight: 1,
          width: 1,
        },
        elevation: elevation,
      },
    });
  });

  return vesselFeatures;
};